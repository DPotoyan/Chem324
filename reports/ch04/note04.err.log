Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import numpy as np
import plotly.graph_objects as go
from scipy.special import sph_harm

# Define the range of m and l values for the first three spherical harmonics
harmonics = [(1, 1), (1, 2), (2, 3)]  # List of (m, l) pairs to plot

# Loop over each harmonic and create a separate subplot
for i, (m, l) in enumerate(harmonics, start=1):
    
    # Calculate the spherical harmonic Y(l, m) and normalize it to [0, 1]
    x, y, z, fcolors_normalized = generate_spherical_harmonic_data(l, m) 
    
    # Add the spherical harmonic to the figure as a surface in a new scene
    fig.add_trace(go.Surface(
        x=x, y=y, z=z,
        surfacecolor=fcolors_normalized,
        colorscale='rdbu',
        showscale=False,
        name=f"$Y_{{{l},{m}}}$",
        scene=f'scene{i}'  # Assign each plot to a different scene
    ))

# Update layout to arrange scenes in a row and add titles as annotations
fig.update_layout(
    title="First Three Spherical Harmonics",
    scene=dict(domain=dict(x=[0, 0.33]), xaxis=dict(visible=False), yaxis=dict(visible=False), zaxis=dict(visible=False), aspectmode='cube'),
    scene2=dict(domain=dict(x=[0.33, 0.66]), xaxis=dict(visible=False), yaxis=dict(visible=False), zaxis=dict(visible=False), aspectmode='cube'),
    scene3=dict(domain=dict(x=[0.66, 1]), xaxis=dict(visible=False), yaxis=dict(visible=False), zaxis=dict(visible=False), aspectmode='cube'),
    annotations=[
        dict(text="$Y_{2,0}$", x=0.16, y=1.05, showarrow=False, xref="paper", yref="paper", font=dict(size=14)),
        dict(text="$Y_{2,1}$", x=0.5, y=1.05, showarrow=False, xref="paper", yref="paper", font=dict(size=14)),
        dict(text="$Y_{2,-1}$", x=0.83, y=1.05, showarrow=False, xref="paper", yref="paper", font=dict(size=14))
    ]
)

# Display the figure
fig.show()

------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mAttributeError[0m                            Traceback (most recent call last)
Cell [0;32mIn[5], line 15[0m
[1;32m     12[0m     x, y, z, fcolors_normalized [38;5;241m=[39m generate_spherical_harmonic_data(l, m) 
[1;32m     14[0m     [38;5;66;03m# Add the spherical harmonic to the figure as a surface in a new scene[39;00m
[0;32m---> 15[0m     [43mfig[49m[38;5;241;43m.[39;49m[43madd_trace[49m(go[38;5;241m.[39mSurface(
[1;32m     16[0m         x[38;5;241m=[39mx, y[38;5;241m=[39my, z[38;5;241m=[39mz,
[1;32m     17[0m         surfacecolor[38;5;241m=[39mfcolors_normalized,
[1;32m     18[0m         colorscale[38;5;241m=[39m[38;5;124m'[39m[38;5;124mrdbu[39m[38;5;124m'[39m,
[1;32m     19[0m         showscale[38;5;241m=[39m[38;5;28;01mFalse[39;00m,
[1;32m     20[0m         name[38;5;241m=[39m[38;5;124mf[39m[38;5;124m"[39m[38;5;124m$Y_[39m[38;5;130;01m{{[39;00m[38;5;132;01m{[39;00ml[38;5;132;01m}[39;00m[38;5;124m,[39m[38;5;132;01m{[39;00mm[38;5;132;01m}[39;00m[38;5;130;01m}}[39;00m[38;5;124m$[39m[38;5;124m"[39m,
[1;32m     21[0m         scene[38;5;241m=[39m[38;5;124mf[39m[38;5;124m'[39m[38;5;124mscene[39m[38;5;132;01m{[39;00mi[38;5;132;01m}[39;00m[38;5;124m'[39m  [38;5;66;03m# Assign each plot to a different scene[39;00m
[1;32m     22[0m     ))
[1;32m     24[0m [38;5;66;03m# Update layout to arrange scenes in a row and add titles as annotations[39;00m
[1;32m     25[0m fig[38;5;241m.[39mupdate_layout(
[1;32m     26[0m     title[38;5;241m=[39m[38;5;124m"[39m[38;5;124mFirst Three Spherical Harmonics[39m[38;5;124m"[39m,
[1;32m     27[0m     scene[38;5;241m=[39m[38;5;28mdict[39m(domain[38;5;241m=[39m[38;5;28mdict[39m(x[38;5;241m=[39m[[38;5;241m0[39m, [38;5;241m0.33[39m]), xaxis[38;5;241m=[39m[38;5;28mdict[39m(visible[38;5;241m=[39m[38;5;28;01mFalse[39;00m), yaxis[38;5;241m=[39m[38;5;28mdict[39m(visible[38;5;241m=[39m[38;5;28;01mFalse[39;00m), zaxis[38;5;241m=[39m[38;5;28mdict[39m(visible[38;5;241m=[39m[38;5;28;01mFalse[39;00m), aspectmode[38;5;241m=[39m[38;5;124m'[39m[38;5;124mcube[39m[38;5;124m'[39m),
[0;32m   (...)[0m
[1;32m     34[0m     ]
[1;32m     35[0m )

[0;31mAttributeError[0m: 'Figure' object has no attribute 'add_trace'

